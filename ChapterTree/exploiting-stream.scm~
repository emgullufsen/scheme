(define (stream-limit-protected in-stream tolerance n)
  (if (< n 1)
      (error "lim exceeded")
      (let* ((scar (stream-car in-stream)) (scdr (stream-car (stream-cdr s))) (tolly (abs (- scar scdr))))
	(if (< tolly tolerance)
	    scdr
	    (stream-limit-protected (stream-cdr in-stream) tolerance (- n 1))))))

(define (stream-limit in-stream tolerance)
  (stream-limit-protected in-stream tolerance 5000))
